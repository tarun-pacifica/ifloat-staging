<%= partial "cached_finds/find_header" %>

<div id="product_detail">

<div id="product_detail_data">
	<div class="title">Common Product Data</div>
	<table> <%= partial "products/property", :with => @common_properties %> </table>
</div>

<div id="product_detail_main">
	<% unless @recent_find.nil? %>
	<a href=<%= resource(@recent_find).inspect %>>
		<div id="cached_find_report">		
			Go back to all the products found for <span class="spec"><%= @recent_find.specification %></span>...
		</div>
	</a>
	<% end %>
	
	<div id="product_detail_diff_summary">
		<img class="main" src=<%= @image.url(:tiny).inspect %> />
		<h1>There are <span><%= @product_count %></span> products with this image</h1>
		<p class="help">Choose one below</p>
		<hr />
	</div>
	
	<div id="product_detail_diff_products">
		<table>
			<tr>
				<td></td>
				<% @diff_properties.each do |property| %>
				<td><img class="icon" src=<%= @icon_urls_by_property_id[property.id].inspect %> onmouseover="bubble_tooltip_show(event, '<%= @friendly_name_sections[property.id].last %>')" onmouseout="bubble_tooltip_hide()" /></td>
				<% end %>
			</tr>
			
			<% parity = :even %>
			<% @values_by_property_by_product_id.each do |product_id, values_by_property| %>
			<tr class="<%= parity = (parity == :even ? :odd : :even) %>">
				<td class="choose"><a href=<%= url(:product, :id => product_id).inspect %>>choose</a></td>
				<% @diff_properties.each do |property| %>
				<% dom_id = "product_#{product_id}_property_#{property.id}" %>
				<td id=<%= dom_id.inspect %>>
					<div class="summary">
						<%= property_summary(dom_id, property.text?, values_by_property[property], @text_value_definitions[property.id]) %>
					</div>
				</td>
				<% end %>
			</tr>
			<% end %>
		</table>
	</div>
</div>

</div>
